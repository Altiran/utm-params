"use strict";function _instanceof(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _utmStorage=_interopRequireDefault(require("./utmStorage"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _extends(){return _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},_extends.apply(this,arguments)}function _classCallCheck(e,t){if(!_instanceof(e,t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}var allowedParams=["utm_source","utm_medium","utm_campaign","utm_content","utm_name","utm_term","initial_utm_source","initial_utm_medium","initial_utm_campaign","initial_utm_content","initial_utm_name","initial_utm_term","gclid"],storage=new _utmStorage.default,UTMParams=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"parse",value:function(){var e=new URL(window.location),t=new URLSearchParams(e.search),a={};return allowedParams.forEach((function(e){a[e]=t.get(e)})),a}},{key:"save",value:function(e){if(!e)return!1;try{var t={},a={};if(_extends(t,e),storage.getItem("utmSavedParams")){var n={};try{n=JSON.parse(storage.getItem("utmSavedParams"))}catch(e){n={}}Object.keys(n).forEach((function(e){e.includes("initial_")||n["initial_"+e]?e.includes("initial_")&&(a[e]=n[e]):a["initial_"+e]=n[e]}))}else Object.keys(t).forEach((function(e){e.includes("initial_")||(a["initial_"+e]=t[e])}));return _extends(t,a),storage.setItem("utmSavedParams",JSON.stringify(t)),!0}catch(e){throw new Error(e)}}},{key:"get",value:function(){var e=storage.getItem("utmSavedParams");return e?JSON.parse(e):null}}]),e}(),_default=UTMParams;function _instanceof(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function _classCallCheck(e,t){if(!_instanceof(e,t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}exports.default=_default,Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var UTMStorage=function(){function e(){_classCallCheck(this,e);try{var t=window.localStorage;this.setItem=t.setItem,this.getItem=t.getItem,this.removeItem=t.removeItem,this.setItem("test","test"),this.removeItem("test")}catch(e){this.prefixToAvoidBuiltIns="_utm_unique_",this.localMockedStorage={},this.setItem=this.setLocalItem,this.getItem=this.getLocalItem}}return _createClass(e,[{key:"setLocalItem",value:function(e,t){this.localMockedStorage[this.prefixToAvoidBuiltIns+e]=t}},{key:"getLocalItem",value:function(e){return this.localMockedStorage[this.prefixToAvoidBuiltIns+e]}}]),e}();_default=UTMStorage;exports.default=_default;